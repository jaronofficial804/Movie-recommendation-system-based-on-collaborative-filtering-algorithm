{% extends "admin.html" %}
{% block admin_main %}
<div class="admin-section">
    <h2>反馈与消息管理</h2>
    <form method="post" class="admin-msg-form">
        <input type="number" name="user_id" placeholder="用户ID" required>
        <input type="text" name="content" placeholder="管理员要发送的消息" required>
        <button class="btn">发送通知</button>
    </form>
    <table class="admin-table">
        <thead>
            <tr>
                <th>ID</th>
                <th>时间</th>
                <th>发送者</th>
                <th>接收者</th>
                <th>类型</th>
                <th>内容</th>
                <th>状态</th>
            </tr>
        </thead>
        <tbody>
        {% for m in inbox %}
        <tr>
            <td>{{ m.id }}</td>
            <td>{{ m.create_time }}</td>
            <td>
                {% if m.sender_id=='admin' %}管理员
                {% else %}用户{{ m.sender_id }}{% endif %}
            </td>
            <td>
                {% if m.receiver_id=='admin' %}管理员
                {% else %}用户{{ m.receiver_id }}{% endif %}
            </td>
            <td>
                {% if m.type=='feedback' %}反馈
                {% elif m.type=='notice' %}通知
                {% else %}{{ m.type }}{% endif %}
            </td>
            <td style="max-width:420px;white-space:pre-wrap;">{{ m.content }}</td>
            <td>{% if m.is_read %}<span style="color:#2ecc71;">已读</span>{% else %}<span style="color:#e67e22;">未读</span>{% endif %}</td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
</div>

<style>
.admin-section {
    padding: 18px 12px 0 12px;
    max-width: 1080px;
    margin: 0 auto;
}
.admin-msg-form {
    display: flex;
    gap: 16px;
    align-items: center;
    background: #f8fbff;
    padding: 22px 16px 20px 16px;
    border-radius: 16px;
    box-shadow: 0 3px 16px #d5eafd15;
    margin-bottom: 24px;
    max-width: 860px;
}
.admin-msg-form input[type="number"],
.admin-msg-form input[type="text"] {
    padding: 10px 18px;
    border-radius: 9px;
    border: 1.2px solid #c6e1fa;
    background: #f4fafd;
    font-size: 1.08em;
    transition: border .16s;
    min-width: 120px;
    flex: 0 1 180px;
}
.admin-msg-form input[type="text"] {
    min-width: 320px;
    flex: 1 1 430px;
}
.admin-msg-form input:focus {
    border: 1.2px solid #4cc9f0;
    outline: none;
}
.admin-msg-form .btn {
    padding: 10px 30px;
    font-size: 1.07em;
    border-radius: 9px;
    background: linear-gradient(90deg, #4cc9f0 0%, #4361ee 100%);
    color: #fff;
    font-weight: 700;
    border: none;
    box-shadow: 0 1.5px 8px #71c3f422;
    transition: background 0.17s;
    cursor: pointer;
}
.admin-msg-form .btn:hover {
    background: linear-gradient(90deg, #4361ee 0%, #4cc9f0 100%);
}
.admin-table {
    width: 100%;
    background: #fff;
    border-radius: 13px;
    box-shadow: 0 2px 14px #bfd0e110;
    border-collapse: separate;
    border-spacing: 0;
    overflow: hidden;
}
.admin-table th, .admin-table td {
    padding: 13px 10px;
    font-size: 1em;
    text-align: left;
    border-bottom: 1.3px solid #eaeaea;
}
.admin-table th {
    background: #f5faff;
    color: #3968b3;
    font-weight: 700;
}
.admin-table tr:last-child td {
    border-bottom: none;
}
@media (max-width:900px) {
    .admin-msg-form { flex-direction: column; gap: 8px; }
    .admin-msg-form input[type="text"] { min-width: 90px; }
}
</style>
{% endblock %}
